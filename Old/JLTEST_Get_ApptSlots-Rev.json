{
  "name": "JLTEST_Get_ApptSlots-CustomTool",
  "description": "Use this tool to fetch available appointment slots from the NexHealth API. This tool returns real-time availability for scheduling appointments.",
  "color": "linear-gradient(rgb(149,71,254), rgb(58,241,133))",
  "iconSrc": "",
  "schema": "[{\"id\":0,\"property\":\"providerId\",\"description\":\"The provider ID to check availability for.\",\"type\":\"string\",\"required\":false},{\"id\":1,\"property\":\"startDate\",\"description\":\"Start date for availability search (format: YYYY-MM-DD). This is REQUIRED - you MUST provide a start date. Use today's date if no preference given.\",\"type\":\"string\",\"required\":true},{\"id\":2,\"property\":\"endDate\",\"description\":\"End date for availability search (format: YYYY-MM-DD). This is REQUIRED - you MUST provide an end date. Use today's date + 30 days if no preference given.\",\"type\":\"string\",\"required\":true},{\"id\":3,\"property\":\"appointmentTypeId\",\"description\":\"Optional appointment type ID to filter availability.\",\"type\":\"string\",\"required\":false}]",
  "func": "const fetch = require('node-fetch');\nlet providerId = null;\nlet startDate = $startDate;\nlet endDate = $endDate;\nlet appointmentTypeId = null;\ntry { providerId = $providerId || null; } catch(e) { providerId = null; }\ntry { appointmentTypeId = $appointmentTypeId || null; } catch(e) { appointmentTypeId = null; }\n\n// Ensure startDate and endDate are provided - they are required\nif (!startDate || startDate === null || startDate === '') {\n    // Default to today if not provided\n    const today = new Date();\n    startDate = today.toISOString().split('T')[0];\n}\nif (!endDate || endDate === null || endDate === '') {\n    // Default to 30 days from today if not provided\n    const today = new Date();\n    const futureDate = new Date(today);\n    futureDate.setDate(today.getDate() + 30);\n    endDate = futureDate.toISOString().split('T')[0];\n}\n\nconst apiKey = `dXNlci0yNzQtcHJvZHVjdGlvbg.eqAjEe1KyadP0pZ56bNbULBObZG3VKqU`;\n\nconst myHeaders = {\n    \"Accept\": \"application/vnd.Nexhealth+json;version=2\",\n    \"Authorization\": apiKey\n};\n\nconst requestOptions = {\n    method: \"POST\",\n    headers: myHeaders,\n    redirect: \"follow\"\n};\n\n// First, authenticate to get the token\nreturn fetch(\"https://nexhealth.info/authenticates\", requestOptions)\n    .then((response) => response.json())\n    .then((authResult) => {\n        console.log('Auth response:', authResult);\n        const authToken = authResult.data.token;\n        console.log('Auth Token:', authToken);\n\n        // Build query parameters for availability endpoint\n        let queryParams = \"subdomain=cdm&location_id=333724\";\n        if (providerId) {\n            queryParams += `&provider_id=${providerId}`;\n        }\n        if (startDate) {\n            queryParams += `&start_date=${startDate}`;\n        }\n        if (endDate) {\n            queryParams += `&end_date=${endDate}`;\n        }\n        if (appointmentTypeId) {\n            queryParams += `&appointment_type_id=${appointmentTypeId}`;\n        }\n\n        // Now get available appointment slots with the auth token\n        const availabilityHeaders = {\n            \"Accept\": \"application/vnd.Nexhealth+json;version=2\",\n            \"Authorization\": \"Bearer \" + authToken\n        };\n\n        const availabilityRequestOptions = {\n            method: \"GET\",\n            headers: availabilityHeaders,\n            redirect: \"follow\"\n        };\n\n        return fetch(`https://nexhealth.info/availability?${queryParams}`, availabilityRequestOptions);\n    })\n    .then((response) => response.json())\n    .then((result) => {\n        console.log('Available appointment slots:', result);\n        const slotsResult = result;\n        console.log(slotsResult);\n        return slotsResult;\n    })\n    .catch((error) => {\n        console.error('Error:', error);\n        throw error;\n    });",
  "workspaceId": "9e7c759d-2623-4529-945d-6c578631aad0"
}